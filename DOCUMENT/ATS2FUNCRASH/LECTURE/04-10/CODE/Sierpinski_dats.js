/*
**
** The JavaScript code is generated by atscc2js
** The starting compilation time is: 2017-9-13: 19h:42m
**
*/

/* ATSextcode_beg() */
//
var
theCanvas =
document.getElementById("theCanvas");
var
theCtx = theCanvas.getContext( '2d' );
//
var N = 6;
//
var W =
theCanvas.width;
var H =
theCanvas.height;
var WH = Math.min(W, H);
var WH2 = 0.88 * WH;
//
function
midpoint
(p1, p2)
{
//
  var
  xmid = (p1.x + p2.x)/2;
  var
  ymid = (p1.y + p2.y)/2;
//
  return { x: xmid, y: ymid };
//
}
//
function
TriangleRemove
 (A, B, C)
{
  theCtx.save();
//
  theCtx.beginPath();
  theCtx.moveTo(A.x, A.y);
  theCtx.lineTo(B.x, B.y);
  theCtx.lineTo(C.x, C.y);
  theCtx.closePath();
//
  theCtx.fill();
//
  theCtx.restore();
} // end of [TriangleRemove]
//
/* ATSextcode_end() */

function
__patsfun_80__closurerize(env0)
{
  return [function(cenv) { return __patsfun_80(cenv[1]); }, env0];
}


function
__patsfun_96__closurerize(env0, env1, env2, env3)
{
  return [function(cenv) { return __patsfun_96(cenv[1], cenv[2], cenv[3], cenv[4]); }, env0, env1, env2, env3];
}


function
_057_home_057_hwxi_057_Research_057_ATS_055_Postiats_057_doc_057_BOOK_057_ATS2FUNCRASH_057_LECTURE_057_04_055_10_057_CODE_057_Sierpinski_056_dats__int_stream_from(arg0)
{
//
// knd = 0
  var tmpret224
  var tmplab, tmplab_js
//
  // __patsflab_int_stream_from
  tmpret224 = ATSPMVlazyval(__patsfun_80__closurerize(arg0));
  return tmpret224;
} // end-of-function


function
__patsfun_80(env0)
{
//
// knd = 0
  var tmpret225
  var tmp226
  var tmp227
  var tmplab, tmplab_js
//
  // __patsflab___patsfun_80
  tmp227 = ats2jspre_add_int0_int0(env0, 1);
  tmp226 = _057_home_057_hwxi_057_Research_057_ATS_055_Postiats_057_doc_057_BOOK_057_ATS2FUNCRASH_057_LECTURE_057_04_055_10_057_CODE_057_Sierpinski_056_dats__int_stream_from(tmp227);
  tmpret225 = [env0, tmp226];
  return tmpret225;
} // end-of-function


function
SierpinskiDraw(arg0, arg1, arg2, arg3)
{
//
// knd = 1
  var apy0
  var apy1
  var apy2
  var apy3
  var tmp268
  var tmp269
  var tmp270
  var tmp271
  var tmp274
  var tmp276
  var tmp277
  var funlab_js
  var tmplab, tmplab_js
//
  while(true) {
    funlab_js = 0;
    // __patsflab_SierpinskiDraw
    tmp268 = ats2jspre_gt_int0_int0(arg0, 0);
    if(tmp268) {
      tmp269 = midpoint(arg1, arg2);
      tmp270 = midpoint(arg2, arg3);
      tmp271 = midpoint(arg3, arg1);
      TriangleRemove(tmp269, tmp270, tmp271);
      tmp274 = ats2jspre_sub_int0_int0(arg0, 1);
      SierpinskiDraw(tmp274, arg1, tmp269, tmp271);
      tmp276 = ats2jspre_sub_int0_int0(arg0, 1);
      SierpinskiDraw(tmp276, arg2, tmp270, tmp269);
      tmp277 = ats2jspre_sub_int0_int0(arg0, 1);
      // ATStailcalseq_beg
      apy0 = tmp277;
      apy1 = arg3;
      apy2 = tmp271;
      apy3 = tmp270;
      arg0 = apy0;
      arg1 = apy1;
      arg2 = apy2;
      arg3 = apy3;
      funlab_js = 1; // __patsflab_SierpinskiDraw
      // ATStailcalseq_end
    } else {
      // ATSINSmove_void
    } // end-of-if
    if (funlab_js > 0) continue; else return/*_void*/;
  } // endwhile-fun
} // end-of-function


function
_057_home_057_hwxi_057_Research_057_ATS_055_Postiats_057_doc_057_BOOK_057_ATS2FUNCRASH_057_LECTURE_057_04_055_10_057_CODE_057_Sierpinski_056_dats__execute_after(arg0, arg1)
{
//
// knd = 0
  var tmp279
  var tmplab, tmplab_js
//
  // __patsflab_execute_after
  tmp279 = ats2jspre_cloref2fun0(arg0);
  setTimeout(tmp279, arg1);
  return/*_void*/;
} // end-of-function


function
repeat_execute_after(arg0, arg1, arg2)
{
//
// knd = 0
  var tmplab, tmplab_js
//
  // __patsflab_repeat_execute_after
  auxmain_95(arg0, arg1, arg2, 0);
  return/*_void*/;
} // end-of-function


function
auxmain_95(env0, env1, env2, arg0)
{
//
// knd = 1
  var apy0
  var tmp282
  var funlab_js
  var tmplab, tmplab_js
//
  while(true) {
    funlab_js = 0;
    // __patsflab_auxmain_95
    tmp282 = ats2jspre_gte_int0_int0(arg0, env0);
    if(tmp282) {
      // ATStailcalseq_beg
      apy0 = 0;
      arg0 = apy0;
      funlab_js = 1; // __patsflab_auxmain_95
      // ATStailcalseq_end
    } else {
      env1(arg0);
      _057_home_057_hwxi_057_Research_057_ATS_055_Postiats_057_doc_057_BOOK_057_ATS2FUNCRASH_057_LECTURE_057_04_055_10_057_CODE_057_Sierpinski_056_dats__execute_after(__patsfun_96__closurerize(env0, env1, env2, arg0), env2);
    } // end-of-if
    if (funlab_js > 0) continue; else return/*_void*/;
  } // endwhile-fun
} // end-of-function


function
__patsfun_96(env0, env1, env2, env3)
{
//
// knd = 0
  var tmp285
  var tmplab, tmplab_js
//
  // __patsflab___patsfun_96
  tmp285 = ats2jspre_add_int0_int0(env3, 1);
  auxmain_95(env0, env1, env2, tmp285);
  return/*_void*/;
} // end-of-function


/* ATSextcode_beg() */
//
function
SierpinskiMain()
{
var A0 =
{x: WH2/2, y: 0  };
var B0 =
{x:     0, y: WH2};
var C0 =
{x: WH2  , y: WH2};
//
theCtx.translate
((W-WH2)/2, (H-WH2)/2);
//
repeat_execute_after
(
N
,
function(i)
{
theCtx.fillStyle="#0000ff";
TriangleRemove(A0, B0, C0);
theCtx.fillStyle="#ffff00";
SierpinskiDraw(i, A0, B0, C0);
}
,
1000/*ms*/
);
//
}
//
/* ATSextcode_end() */

/* ATSextcode_beg() */
//
jQuery(document).ready(function(){SierpinskiMain();});
//
/* ATSextcode_end() */

/* ****** ****** */

/* end-of-compilation-unit */
