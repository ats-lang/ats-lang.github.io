<!DOCTYPE html>
<html>
<head>
<title>BUCASCS320-assign02_sol</title>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<style type="text/css">
  .patsyntax {width:100%;margin:auto;}
  .patsyntax {color:#808080;background-color:#E0E0E0;}
  .patsyntax span.keyword {color:#000000;font-weight:bold;}
  .patsyntax span.comment {color:#787878;font-style:italic;}
  .patsyntax span.extcode {color:#A52A2A;}
  .patsyntax span.neuexp  {color:#800080;}
  .patsyntax span.staexp  {color:#0000F0;}
  .patsyntax span.prfexp  {color:#603030;}
  .patsyntax span.dynexp  {color:#F00000;}
  .patsyntax span.stalab  {color:#0000F0;font-style:italic}
  .patsyntax span.dynlab  {color:#F00000;font-style:italic}
  .patsyntax span.dynstr  {color:#008000;font-style:normal}
  .patsyntax span.stacstdec  {text-decoration:none;}
  .patsyntax span.stacstuse  {color:#0000CF;text-decoration:underline;}
  .patsyntax span.dyncstdec  {text-decoration:none;}
  .patsyntax span.dyncstuse  {color:#B80000;text-decoration:underline;}
  .patsyntax span.dyncst_implement  {color:#B80000;text-decoration:underline;}
</style>
<script
 src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js">
</script>
<script
 src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js">
</script>
<script
 src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2014-11-29/FileSaver.min.js">
</script>
<script
 src="https://ats-lang.github.io/LIBRARY/libatscc2js/libatscc2js_all.js">
</script>
<script
 src="https://ats-lang.github.io/LIBRARY/libatscc2js/libatscc2js_print_store_cats.js">
</script>
<script
 src="https://ats-lang.github.io/LIBRARY/ats2langweb/pats2xhtmlize_dats.js">
</script>
<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
</head>
<body>
<div
 class="container-fluid">

<h1>Assignment-Sol #2</h1>

<p>
The following function ##fun("fib")
computes Fibonacci numbers:

<p></p>

<div>
<dats2xhtml>//
fun
fib(n: int): int =
  if n >= 2 then fib(n-1) + fib(n-2) else n
//</dats2xhtml>
</div>

<p></p>

Clearly, ##fun("fib") is recursive but not tail-recursive:
Neither of the two recursive calls in the body of ##fun("fib")
is a tail-call. Please give a tail-recursive implementation
of ##fun("fib_trec") that also computes Fibonacci numbers:

<p></p>

<div>
<sats2xhtml>//
fun fib_trec(n: int): int
//</sats2xhtml>
</div>

</p>

<hr></hr>
A tail-recursive implementation of ##fun("fib_trec")
is given in the following window:<br>

<table class="table">
<thead>
<tr>
<th class="text-center" width="50%">Source</th>
<th class="text-center" width="50%">Output</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">
<button
 type="button"
 id="assign02_sol_patssrc_saveAs_button"
 onclick="assign02_patssrc_saveAs_onclick('assign02_sol')"
>saveAs</button>
<input
 type="text"
 id="assign02_sol_patssrc_saveAs_input"
 size=18 maxlength=32
 placeholder="assign02_sol.dats"></input>
</td>
<td align="center">
</td>
</tr>
<tr
 id="assign02_sol_table_tr1">
<td align="center">
<textarea
 id="assign02_sol_source"
 rows=41 cols=80
 spellcheck="false">
//
#define
ATS_MAINATSFLAG 1
#define
ATS_DYNLOADNAME "my_dynload"
//
#include
"share/atspre_define.hats"
#include
"{$LIBATSCC2JS}/staloadall.hats"
//
staload
"{$LIBATSCC2JS}/SATS/print.sats"
//
%{$
//
ats2jspre_the_print_store_clear();
my_dynload();
alert(ats2jspre_the_print_store_join());
//
%} // end of [%{$]
//
extern
fun
fib_trec (n: int): int
//
val () = println! ("fib_trec(10) = ", fib_trec(10))
val () = println! ("fib_trec(20) = ", fib_trec(20))
//
(*
** Please add your code below this comment:
*)
implement
fib_trec(n) = (
//
fix
f(n: int, r: int, s: int): int =>
  if n >= 2 then f(n-1, s, r+s) else (if n >= 1 then s else r)
//
)(n, 0(*fib0*), 1(*fib1*))
//</textarea>
</td>
<td align="center">
<textarea
 id="assign02_sol_output"
 rows=0 cols=0
 spellcheck="false"
 placeholder="The output goes here...">
</textarea>
</td>
</tr>
<tr
 id="assign02_sol_table_tr2"
 hidden="hidden">
<td align="center">
<pre
 class="text-left"
 id="assign02_sol_source2">source2
</pre>
</td>
<td align="center">
<div
 class="text-left"
 id="assign02_sol_output2">output2
</div>
</td>
</tr>
<tr>
<td align="center">
<button
 type="button"
 id="assign02_sol_patsopt_tc_button"
 onclick="assign02_patsopt_tc_onclick('assign02_sol')"
>patsopt_tc</button>
<button
 type="button"
 id="assign02_sol_patsopt_cc_button"
 onclick="assign02_patsopt_cc_onclick('assign02_sol')"
>patsopt_cc</button>
<button
 type="button"
 id="assign02_sol_patsopt_cc2js_button"
 onclick="assign02_patsopt_cc2js_onclick('assign02_sol')"
>patsopt_cc2js</button>
<button
 type="button"
 id="assign02_sol_pats2xhtml_button"
 onclick="assign02_pats2xhtml_toggle_onclick('assign02_sol')"
>pats2xhtml-toggle</button>
</td>
<td></td>
</tr>
</tbody>
</table>
<hr></hr>
<p>
The functionalities of the above buttons
can be briefly described as follows:
</p>
<ul>
<li> Patsopt-tc: for typechecking ATS code.
<li> Patsopt-cc: for typechecking and compiling ATS code to C.
<li> Patsopt-cc2js: for compiling ATS code to JS and then evaluating the JS code.
<li> Pats2xhtml-toggle: for syntax-hiliting ATS code and adding/removing line numbers.
</ul>
<hr></hr>
<p>
The Python3 code generating this page is prepared with atscc2py3.
</p>
<script
 src="https://ats-lang.github.io/LIBRARY/libtutoriats/libtutoriats_assign02_patsopt_services_dats.js">
</script>
<script>
$(document).ready(function(){pats2xhtmlize_process_all();return;});
$(document).ready(function(){assign02_patsopt_services_initize("assign02_sol");return;});
</script>
</div>
</body>
</html>
